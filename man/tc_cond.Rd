% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tc_cond.R
\name{tc_cond}
\alias{tc_cond}
\alias{tc_cprob}
\alias{tc_cmarg}
\title{Conditional tail calibration}
\usage{
tc_cond(
  y,
  F_x,
  t,
  type = c("prob", "marg"),
  ratio = c("com", "sev", "occ"),
  u = seq(0, 1, 0.01),
  group = NULL,
  sup = TRUE,
  qu = FALSE,
  subset = rep(TRUE, length(y)),
  ...
)

tc_cprob(
  y,
  F_x,
  t,
  group,
  ratio = c("com", "sev", "occ"),
  u = seq(0, 1, 0.01),
  sup = TRUE,
  qu = FALSE,
  subset = rep(TRUE, length(y)),
  ...
)

tc_cmarg(
  y,
  F_x,
  t,
  group,
  ratio = c("com", "sev", "occ"),
  u = seq(0, 1, 0.01),
  sup = TRUE,
  qu = FALSE,
  subset = rep(TRUE, length(y)),
  ...
)
}
\arguments{
\item{y}{vector of observations.}

\item{F_x}{forecast distribution function to be evaluated.}

\item{t}{vector of threshold(s) at which to evaluate tail calibration.}

\item{type}{string denoting whether to assess marginal ('marg') or probabilistic ('prob') tail calibration.}

\item{ratio}{ratio to return; one of 'com', 'sev', 'occ'.}

\item{u}{vector of values at which to assess tail calibration.}

\item{group}{vector specifying observations that should be grouped together.}

\item{sup}{logical specifying whether to quantify miscalibration using the supremum distance; default is \code{FALSE}.}

\item{qu}{logical specifying whether the thresholds should be renamed in terms of
quantiles of \code{y}; default is \code{FALSE}.}

\item{subset}{logical vector of the same length as \code{y}, allowing only a subset
of the forecasts and observations (where \code{TRUE}) to be assessed.}

\item{...}{additional arguments to F_x.}
}
\value{
A list of data frames (for each group) or a list of a list of data frames (for each group
and threshold \code{t}) containing the requested ratio quantifying tail calibration.
}
\description{
Assess the tail calibration of probabilistic forecasts conditional on non-trivial
information sets.
}
\section{Details}{


\code{tc_cond()} is a wrapper for \code{tc_cprob} if \code{type == 'prob'} and
\code{tc_cmarg} if \code{type == 'marg'}, which are themselves wrappers for
\code{\link{tc_prob}} and \code{\link{tc_marg}}, respectively. More details can be
found in their respective help pages.

\code{tc_cprob} and \code{tc_cmarg} stratify the forecasts and observations into
different groups, according to the input vector \code{group}. \code{group} should
be a vector of the same length as \code{y}, containing a relatively small number of
unique entries. Observations \code{y} that have the same value of \code{group} are
grouped together, and the standard notions of probabilistic (\code{type == 'prob'})
or marginal tail calibration (\code{type == 'marg'}) are then assessed using the
functionality in \code{tc_prob} or \code{tc_marg}, respectively.
}

\section{References}{

\emph{Probabilistic calibration:}

Diebold, F., Gunther, T.A., and Tay, A.S. (1998):
`Evaluating Density Forecasts with Applications to Financial Risk Management'
\emph{International Economic Review}, 39, 863-883.
DOI: 10.2307/2527342


Gneiting, T., Balabdaoui, F., and Raftery, A. E. (2007):
`Probabilistic forecasts, calibration and sharpness'
\emph{Journal of the Royal Statistical Society Series B: Statistical Methodology}, 69, 243-268.
DOI: 10.1111/j.1467-9868.2007.00587.x


Gneiting, T. and Resin, J. (2022):
`Regression diagnostics meets forecast evaluation: Conditional calibration, reliability diagrams, and coefficient of determination',
\emph{Electronic Journal of Statistics}, 17, 3226-3286.
DOI: 10.1214/23-EJS2180


\emph{Probabilistic tail calibration:}

Allen, S., Koh, J., Segers, J. and Ziegel, J. (2024+):
`Tail calibration of probabilistic forecasts'.
\emph{arXiv pre-print}.


\emph{Marginal calibration:}

Gneiting, T., Balabdaoui, F., and Raftery, A. E. (2007):
`Probabilistic forecasts, calibration and sharpness'
\emph{Journal of the Royal Statistical Society Series B: Statistical Methodology}, 69, 243-268.
DOI: 10.1111/j.1467-9868.2007.00587.x


Gneiting, T. and Resin, J. (2022):
`Regression diagnostics meets forecast evaluation: Conditional calibration, reliability diagrams, and coefficient of determination',
\emph{Electronic Journal of Statistics}, 17, 3226-3286.
DOI: 10.1214/23-EJS2180


\emph{Marginal tail calibration:}

Allen, S., Koh, J., Segers, J. and Ziegel, J. (2024+):
`Tail calibration of probabilistic forecasts'.
\emph{arXiv pre-print}.
}

\examples{
n <- 1e5
y <- rnorm(n)
F_x <- pnorm
mu <- rnorm(n, sd = 0.5)

# standard calibration is assessed by setting t to -Inf
ptc <- tc_prob(y, F_x, t = -Inf, mean = mu)
ptc_cond <- tc_cprob(y, F_x, t = -Inf, group = rep(1, length(y)), sup = FALSE, mean = mu)
ptc_cond2 <- tc_cond(y, F_x, t = -Inf, group = rep(1, length(y)), sup = FALSE, mean = mu)

mtc <- tc_prob(y, F_x, t = -Inf, type = 'marg', mean = mu)
mtc_cond <- tc_cmarg(y, F_x, t = -Inf, group = rep(1, length(y)), sup = FALSE, mean = mu)
mtc_cond2 <- tc_cond(y, F_x, t = -Inf, type = 'marg', group = rep(1, length(y)), sup = FALSE, mean = mu)

# we can condition on arbitrary groupings of the observations
group <- sample(c('A', 'B'), length(y), replace = TRUE)
t <- c(-Inf, 0, 1, 2)
sev <- tc_cond(y, F_x, t = t, ratio = 'sev', group = group, mean = mu)
occ <- tc_cond(y, F_x, t = t, ratio = 'occ', group = group, mean = mu)


}
\author{
Sam Allen
}
